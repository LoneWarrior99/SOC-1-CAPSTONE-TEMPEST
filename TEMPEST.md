- Tempest Incident -
In this incident, you will act as an Incident Responder from an alert triaged by one of your Security Operations Center analysts. The analyst has confirmed that the alert has a CRITICAL severity that needs further investigation.
As reported by the SOC analyst, the intrusion started from a malicious document. In addition, the analyst compiled the essential information generated by the alert as listed below:
The malicious document has a .doc extension.
The user downloaded the malicious document via chrome.exe.
The malicious document then executed a chain of commands to attain code execution.

-
The user of this machine was compromised by a malicious document. What is the file name of the document?
Report stated that intrusion started from a malicious doc file with .doc extension. Used Timeline Explorer and searched for “.doc” to find file name.

![image](https://github.com/user-attachments/assets/b8d0e790-f8f1-4f55-bb52-3a2a78482d38)


What is the name of the compromised user and machine?
Can use the same line we used last time to find Username and machine name
benimaru-TEMPEST
What is the PID of the Microsoft Word process that opened the malicious document?
Opened with Winword.exe from Benimaru we can look under Payload Data1 on the same line to see PID : 496
Based on Sysmon logs, what is the IPv4 address resolved by the malicious domain used in the previous question?
What we know: PID:496, DNS Query EventID:22.
Filter for these and we can find query results under Payload Data6
167.71.199.191


What is the base64 encoded string in the malicious payload executed by the document?
What we know: Parent ID should be 496, Process creation event id: 1
Filter for this and we can find the answer under executable info






What is the CVE number of the exploit used by the attacker to achieve a remote code execution?
Looking at the contents we can see the initial .exe and we can search for that on google to see if there are any matches.








Initial Access - Stage 2 execution
Malicious Document - Stage 2
Based on the initial findings, we discovered that there is a stage 2 execution:
The document has successfully executed an encoded base64 command.
Decoding this string reveals the exact command chain executed by the malicious document.
Investigation Guide
With the following discoveries, we may refer again to the cheatsheet to continue with the investigation:
The Autostart execution reflects explorer.exe as its parent process ID.
Child processes of explorer.exe within the event timeframe could be significant.
Process Creation (Event ID 1) and File Creation (Event ID 11) succeeding the document execution are worth checking.
Significant Data Sources:
Sysmon

The malicious execution of the payload wrote a file on the system. What is the full target path of the payload?
Filter for File Creation (Event ID 11) and startup under payload data4 
 	
The implanted payload executes once the user logs into the machine. What is the executed command upon a successful login of the compromised user?
Refer to the Guide, Filter for Process Creation (Event ID 1) and contains parent process explorer, and user Benimaru

Based on Sysmon logs, what is the SHA256 hash of the malicious binary downloaded for stage 2 execution?
We can keep the same event id and username filter but we want to look at the child process, first.exe under the executable info
We can find the sha256 under payload data3 under its original path

The stage 2 payload downloaded establishes a connection to a c2 server. What is the domain and port used by the attacker?
Using sysmon view to assist, we can look at the GUI view for first.exe and see the answer


